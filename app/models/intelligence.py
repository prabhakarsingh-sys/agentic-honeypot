"""Intelligence models."""
from typing import List
from pydantic import BaseModel, Field


class ExtractedIntelligence(BaseModel):
    """Structured intelligence extracted from conversations."""
    bankAccounts: List[str] = Field(default_factory=list)
    upiIds: List[str] = Field(default_factory=list)
    phishingLinks: List[str] = Field(default_factory=list)
    phoneNumbers: List[str] = Field(default_factory=list)
    suspiciousKeywords: List[str] = Field(default_factory=list)


class GuviCallbackPayload(BaseModel):
    """Payload for GUVI evaluation callback."""
    sessionId: str
    scamDetected: bool
    totalMessagesExchanged: int
    extractedIntelligence: ExtractedIntelligence
    agentNotes: str
